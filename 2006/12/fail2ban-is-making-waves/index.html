<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/2006/styles.742409eb857ab2ccca34.css" data-identity="gatsby-global-css">li{margin-right:1rem}h1,li{display:inline-block}h1{font-style:normal;margin-top:0}header{margin-bottom:1.5rem}header ul{float:right;list-style:none}#wrapper{margin:3em auto;max-width:700px;padding:10px}.blogPostDate{color:#333;font-size:8pt;margin-bottom:9px;padding-top:4px}</style><meta name="generator" content="Gatsby 4.4.0"/><title data-react-helmet="true">fail2ban is making waves</title><link data-react-helmet="true" rel="canonical" href="https://www.docunext.com/2006/12/fail2ban-is-making-waves/"/><link as="script" rel="preload" href="/2006/webpack-runtime-ca553f407e64246f1a94.js"/><link as="script" rel="preload" href="/2006/framework-3b46cba0dfed09aeeb64.js"/><link as="script" rel="preload" href="/2006/app-64d5c74e614133e99801.js"/><link as="script" rel="preload" href="/2006/commons-07a951b24cae11aa6a48.js"/><link as="script" rel="preload" href="/2006/component---src-templates-blog-post-js-4450b810c5cd340eaea8.js"/><link as="fetch" rel="preload" href="/2006/page-data/2006/12/fail2ban-is-making-waves/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/2006/page-data/sq/d/4224293195.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/2006/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="wrapper"><header><ul><li><a href="/about/">About</a></li></ul><a href="/"><h1>Docunext</h1></a></header><hr/><div><h2>fail2ban is making waves</h2><div class="blogPostDate">December 2nd, 2006</div><div><p>I'm really starting to like fail2ban. It just when through a major overhaul, and while I was pulling my hair out for awhile trying to figure out the new layout, it makes a lot of sense. I'm adjusting my custom rulesets to the new layout. These are designed to prevent continous dnsrbl rejects, unknown domain rejects, and brute force attempts to send spam, all from the same IP. Will they ever learn? Doubtful.</p>
<p>Here's what I've come up with:</p>
<p>/etc/fail2ban/filter.d/pstdns.local:</p>
<pre>failregex = NOQUEUE: reject: RCPT from \S*\[(?P&lt;host>\S+)\]: 554&lt;/host></pre>
<p>/etc/fail2ban/filter.d/pstdom.local:</p>
<pre>failregex = NOQUEUE: reject: RCPT from \S*\[(?P&lt;host>\S+)\]: 450&lt;/host></pre>
<p>/etc/fail2ban/filter.d/pstnorcpt.local:</p>
<pre>failregex = NOQUEUE: reject: RCPT from \S*\[(?P&lt;host>\S+)\]: 550&lt;/host></pre>
<p>I'm going to submit these rules to the debian maintainer to see if they are interested in using them.</p>
<p>Important thing to note here, is that the first one is based upon using realtime black lists to block proxy and open relays, which are infamous for sending spam. There are a few amazing free services, like sorbs, which provide this service. My thoughts are that an IP will likely get blocked for longer than an hour, or even a few, so it doesn't make sense to simply keep querying the dnsbl to ask if the ip is blacklisted. Therefore, if it is blacklisted, and the offender keeps trying because their bot is too dumb to give up, then their packets get dropped. Logical? I think so.</p>
<p>The other rules for non-existent "from domains" and recipients have to be much more lenient, but still help the worst offenders.</p>
<p>My email to the package maintainer:</p>
<blockquote>Hi,
<p>Here are some rules I use on Debian for fail2ban to block relentless spammers. This is not for protection against password crack attempts, but more for reducing traffic and generally blocking bad ips. I've posted more information here:</p>
<p><a href="http://www.docunext.com/2006/12/fail2ban-is-making-waves/">fail2ban is making waves</a></p>
<p>Thanks,</p>
<p>Docunext Staff</blockquote></p>
<p>¥</p></div></div><div><span>Yearly Indexes: </span><span><a href="/2003"><span>2003</span></a> </span><span><a href="/2004"><span>2004</span></a> </span><span><a href="/2006"><span>2006</span></a> </span><span><a href="/2007"><span>2007</span></a> </span><span><a href="/2008"><span>2008</span></a> </span><span><a href="/2009"><span>2009</span></a> </span><span><a href="/2010"><span>2010</span></a> </span><span><a href="/2011"><span>2011</span></a> </span><span><a href="/2012"><span>2012</span></a> </span><span><a href="/2013"><span>2013</span></a> </span><span><a href="/2015"><span>2015</span></a> </span><span><a href="/2019"><span>2019</span></a> </span><span><a href="/2020"><span>2020</span></a> </span><span><a href="/2022"><span>2022</span></a> </span></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2006/12/fail2ban-is-making-waves/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-4633e8f6cc7cf1607dae.js"],"app":["/app-64d5c74e614133e99801.js"],"component---src-pages-index-js":["/component---src-pages-index-js-a8b57182e60688a12d91.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-4450b810c5cd340eaea8.js"],"component---src-templates-year-js":["/component---src-templates-year-js-0397176bed9177a29771.js"]};/*]]>*/</script><script src="/2006/polyfill-4633e8f6cc7cf1607dae.js" nomodule=""></script><script src="/2006/component---src-templates-blog-post-js-4450b810c5cd340eaea8.js" async=""></script><script src="/2006/commons-07a951b24cae11aa6a48.js" async=""></script><script src="/2006/app-64d5c74e614133e99801.js" async=""></script><script src="/2006/framework-3b46cba0dfed09aeeb64.js" async=""></script><script src="/2006/webpack-runtime-ca553f407e64246f1a94.js" async=""></script></body></html>